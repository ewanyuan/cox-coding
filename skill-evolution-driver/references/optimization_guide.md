# 技能优化指南

## 目录
- [优化类型](#优化类型)
- [可行性评估](#可行性评估)
- [测试标准](#测试标准)
- [版本号管理](#版本号管理)
- [最佳实践](#最佳实践)

## 优化类型

### format_improvement
**描述**：改进技能文件的格式

**常见场景**：
- SKILL.md前言区格式不规范
- 缺少必要字段（如version）
- 目录结构不符合规范
- 文件命名不符合规范

**优化策略**：
- 修正YAML格式错误
- 添加缺失的字段
- 调整目录结构
- 规范化文件命名

**风险等级**：低

### content_optimization
**描述**：优化技能内容

**常见场景**：
- 文档内容冗余
- 说明不够清晰
- 示例过时
- 缺少必要的使用指导

**优化策略**：
- 删除冗余内容
- 补充必要说明
- 更新过时示例
- 添加最佳实践

**风险等级**：中

### version_update
**描述**：更新技能版本号

**常见场景**：
- 初始技能添加版本号
- 优化完成后更新版本号

**优化策略**：
- 遵循语义化版本规范
- 根据变更类型选择版本类型

**风险等级**：低

### bug_fix
**描述**：修复技能中的错误

**常见场景**：
- 脚本语法错误
- 文档内容错误
- 路径引用错误
- 依赖版本错误

**优化策略**：
- 修复脚本语法
- 修正文档内容
- 更新路径引用
- 调整依赖版本

**风险等级**：高

### feature_enhancement
**描述**：增强技能功能

**常见场景**：
- 添加新的功能点
- 扩展现有能力
- 集成新的工具或服务
- 改进用户体验

**优化策略**：
- 设计新功能的实现方案
- 更新SKILL.md和脚本
- 添加必要的参考文档
- 更新使用示例

**风险等级**：高

## 可行性评估

### 评估标准

**1. 技能完整性**
- 技能目录存在且完整
- SKILL.md格式正确
- 必要的脚本和参考文档存在

**2. 优化内容明确**
- 优化目标清晰
- 优化内容具体
- 影响范围可控

**3. 技术可行性**
- 技术方案可行
- 所需资源可用
- 风险可控

**4. 兼容性**
- 不破坏现有功能
- 向后兼容
- 不影响其他技能

### 不可行情况

**技能目录损坏**
- 技能目录不存在
- SKILL.md严重损坏
- 关键脚本丢失

**优化内容不明确**
- 优化目标模糊
- 优化内容过于复杂
- 影响范围难以评估

**技术不可行**
- 缺乏必要的技术支持
- 需要重写大量代码
- 技术风险过高

**兼容性问题**
- 破坏现有功能
- 不兼容的变更
- 影响其他技能的依赖

## 测试标准

### 1. SKILL.md格式验证

**YAML前言区验证**
- 以`---`开头和结尾
- 包含`name`字段
- 包含`description`字段
- 包含`version`字段（如果优化涉及版本）
- `dependency`字段格式正确

**正文验证**
- 不超过500行
- 链接层级不超过一层
- 使用祈使语气
- 格式规范

### 2. 脚本语法检查

**Python脚本**
- 无语法错误
- 导入模块可用
- 函数定义完整
- 参数定义清晰

**Bash脚本**
- 无语法错误
- 命令可用
- 路径正确
- 权限正确

### 3. 目录结构验证

**固定结构**
- SKILL.md存在
- scripts/目录存在（可选，但有脚本时必须）
- references/目录存在（可选，但有参考文档时必须）
- assets/目录存在（可选，但有资产时必须）

**额外文件**
- 无临时文件
- 无缓存文件
- 无日志文件

### 4. 依赖完整性检查

**Python依赖**
- `dependency.python`字段格式正确
- 包名和版本号正确
- 不包含安装命令

**系统依赖**
- `dependency.system`字段格式正确
- 命令行命令有效
- 不包含Python包安装命令

### 5. 功能验证

**核心功能**
- 主要功能可用
- 脚本可执行
- 参数正确

**集成测试**
- 与其他技能集成正常
- 数据格式正确
- 路径引用正确

## 版本号管理

### 语义化版本规范

版本号格式：`v<主版本>.<次版本>.<修订版本>`

**主版本（Major）**
- 重大变更
- 不兼容的API变更
- 移除重要功能
- 示例：v1.0.0 -> v2.0.0

**次版本（Minor）**
- 功能增强
- 向后兼容的新功能
- 添加新的功能点
- 示例：v1.0.0 -> v1.1.0

**修订版本（Patch）**
- Bug修复
- 小改进
- 格式改进
- 文档更新
- 示例：v1.0.0 -> v1.0.1

### 版本号更新规则

**format_improvement**
- 版本类型：patch
- 示例：v1.0.0 -> v1.0.1

**content_optimization**
- 版本类型：patch（小改进）或 minor（重要改进）
- 示例：v1.0.0 -> v1.0.1 或 v1.0.0 -> v1.1.0

**version_update**
- 版本类型：patch
- 示例：无 -> v1.0.0

**bug_fix**
- 版本类型：patch（小bug）或 minor（重要bug）
- 示例：v1.0.0 -> v1.0.1 或 v1.0.0 -> v1.1.0

**feature_enhancement**
- 版本类型：minor（小功能）或 major（重大功能）
- 示例：v1.0.0 -> v1.1.0 或 v1.0.0 -> v2.0.0

### 初始版本号

如果技能没有版本号，设置为：`v1.0.0`

## 最佳实践

### 优化前
1. 充分分析优化机会
2. 评估优化可行性
3. 明确优化目标和范围
4. 评估优化风险
5. 准备回滚方案

### 优化中
1. 始终保持备份
2. 逐步进行，小步快跑
3. 保持task状态同步更新
4. 记录详细的优化日志
5. 及时处理问题

### 优化后
1. 全面测试验证
2. 更新文档和示例
3. 通知用户新的变更
4. 提醒用户重新加载技能
5. 清理临时文件

### 版本管理
1. 遵循语义化版本规范
2. 根据变更类型选择版本类型
3. 保持版本号递增
4. 记录版本变更日志
5. 定期清理过期备份

### 风险控制
1. 优先处理低风险、高价值的优化
2. 避免批量优化
3. 重大变更需用户确认
4. 保持兼容性
5. 准备回滚方案

### 用户体验
1. 提供清晰的优化说明
2. 及时通知用户优化结果
3. 提供回滚选项
4. 帮助用户重新加载技能
5. 收集用户反馈

## 优化示例

### 示例1：添加version字段

**检测**：SKILL.md缺少version字段

**优化类型**：version_update

**优化步骤**：
1. 备份技能
2. 在SKILL.md前言区添加version: v1.0.0
3. 测试验证：SKILL.md格式正确
4. 更新任务状态：completed

**风险等级**：低

### 示例2：修正格式错误

**检测**：SKILL.md前言区格式不规范

**优化类型**：format_improvement

**优化步骤**：
1. 备份技能
2. 修正YAML格式
3. 更新版本号：v1.0.0 -> v1.0.1
4. 测试验证：SKILL.md格式正确
5. 更新任务状态：completed

**风险等级**：低

### 示例3：修复脚本语法错误

**检测**：脚本存在语法错误

**优化类型**：bug_fix

**优化步骤**：
1. 备份技能
2. 修复脚本语法错误
3. 更新版本号：v1.0.0 -> v1.0.1
4. 测试验证：脚本语法正确
5. 更新任务状态：completed

**风险等级**：高

### 示例4：添加新功能

**检测**：需要添加新功能

**优化类型**：feature_enhancement

**优化步骤**：
1. 分析可行性
2. 设计功能方案
3. 备份技能
4. 实现新功能
5. 更新文档
6. 更新版本号：v1.0.0 -> v1.1.0
7. 测试验证
8. 更新任务状态：completed

**风险等级**：高
