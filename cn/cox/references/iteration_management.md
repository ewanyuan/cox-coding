# 迭代管理流程详细指南

## 概述

本文档提供SKILL.md中迭代管理流程的详细实现指南和具体操作说明。

## 触发条件与MVP原则

### 触发条件
当用户提出以下需求时，智能体应主动启用迭代管理流程：
- 开发新功能
- 构建新项目  
- 进行复杂需求实现

### MVP驱动的迭代拆分原则
详细实现指南：

**第一迭代 - 核心功能**
- **识别方法**：分析用户需求，找出用户最关心的核心功能点
- **实现策略**：使用最简单的技术方案，避免过度设计
- **交付标准**：确保核心功能可用，用户能够验证

**第二迭代 - 增强功能**
- **反馈收集**：基于第一迭代的用户反馈调整方向
- **功能扩展**：添加次要但重要的功能
- **体验优化**：改进用户界面和交互体验

**后续迭代 - 完善与优化**
- **细节完善**：处理边缘情况和异常处理
- **性能优化**：提升系统性能和响应速度
- **代码质量**：重构和优化代码结构

## 迭代规划方法详细实现

### 两阶段规划详细步骤

**阶段1 - 项目启动时**
```bash
# 生成迭代框架
python scripts/generate_observability_data.py \
  --mode complete \
  --project-name "项目名称" \
  --app-name "应用名称" \
  --iterations 3 \
  --modules '["模块1", "模块2", "模块3"]'
```

**阶段2 - 逐个迭代详细规划**
- **任务拆解**：将迭代目标分解为具体可执行的任务
- **优先级排序**：根据重要性和依赖关系排序任务
- **风险评估**：评估每个任务的风险等级

## 迭代管理流程详细步骤

### 步骤1：需求分析与迭代拆分
**详细操作指南**：
1. **需求理解**：通过对话确认用户真实需求
2. **功能识别**：列出所有用户可见的功能点
3. **优先级排序**：按用户价值排序功能点
4. **迭代划分**：将功能点分配到不同迭代

### 步骤2：数据生成脚本调用
**详细参数说明**：
```bash
python scripts/generate_observability_data.py \
  --mode complete \
  --project-name "项目名称" \
  --app-name "应用名称" \
  --iterations 3 \
  --modules '[{"id":"MOD-001","name":"模块1"},{"id":"MOD-002","name":"模块2"}]' \
  --iteration-names '["迭代1名称", "迭代2名称", "迭代3名称"]'
```

**任务生成原则**：
- 脚本只生成空的tasks数组
- 所有任务字段由智能体根据实际需求填写
- 避免使用示例数据，保持数据真实性

### 步骤3：任务拆解与填充
**详细任务字段说明**：
```json
{
  "task_id": "TASK-001",
  "task_name": "具体任务描述",
  "status": "todo/in_progress/completed/delayed",
  "assignee": "负责人（可选）",
  "priority": "low/medium/high/critical",
  "risk_level": "low/high",
  "tags": ["标签1", "标签2"]
}
```

**任务拆解最佳实践**：
- 每个任务应聚焦于一个明确的目标
- 任务大小适中，便于跟踪和验证
- 考虑任务之间的依赖关系

### 步骤4：与用户确认迭代计划
**确认流程**：
1. 展示迭代计划和预期成果
2. 解释每个迭代的目标和价值
3. 确认用户同意并收集反馈
4. 根据反馈调整计划

### 步骤5：与开发技能协作
**协作模式**：
1. 将任务列表传递给开发技能
2. 开发技能实现具体功能
3. COX跟踪进度并更新数据
4. 定期与用户确认成果

## 任务风险评估与实施决策

### 风险评估详细标准

**高风险任务特征**：
- 修改核心模块或多文件
- 影响多个功能模块
- 涉及数据结构变更或架构调整
- 难以回滚的修改

**低风险任务特征**：
- 单文件或局部修改
- 影响单一功能
- UI调整或文本修改
- 容易回滚的修改

### 实施决策详细逻辑

**排序规则**：
1. 按优先级排序：critical > high > medium > low
2. 按风险等级分组：高风险任务单独处理

**实施策略矩阵**：
| 优先级 | 风险等级 | 策略 | 验证方式 |
|--------|----------|------|----------|
| Critical | Low | 批量处理 | 批量验证 |
| Critical | High | 单独处理 | 立即验证 |
| High | Low | 批量处理 | 批量验证 |
| High | High | 单独处理 | 立即验证 |
| Medium/Low | Low | 批量处理 | 批量验证 |
| Medium/Low | High | 单独处理 | 根据情况验证 |

### 用户提醒详细格式

**高风险任务实施前提醒**：
```
**COX 提醒您**：即将实施高风险任务「任务名称」。
- 涉及文件：文件列表
- 影响范围：影响说明
- 完成后请立即验证相关功能
```

**高风险任务实施后提醒**：
```
**COX 提醒您**：高风险任务「任务名称」已完成。
请立即验证以下功能：
1. 功能1
2. 功能2
3. 功能3

验证通过后，我将继续下一个任务。
```

## 模块成熟度更新

### 更新触发方式

**方式1：AI主动询问**
- **时机**：迭代完成、重要里程碑
- **内容**：模块状态、完成率、备注
- **方式**：自动更新app_status.json

**方式2：交互网页支持**
- **场景**：使用交互网页方案
- **操作**：用户在网页上直接修改
- **优势**：用户可以随时更新

### 模块状态管理

**状态流转**：
- pending → in_progress → developed → confirmed → optimized
- 每个状态对应不同的完成率和验证要求

### 具体操作流程

模块状态更新的具体操作流程、update-module命令使用和对话示例见 [agent_workflows.md](agent_workflows.md) 的"模块状态更新流程"章节。

## 网页显示说明

### 迭代分组显示
- **迭代卡片**：每个迭代独立显示
- **当前迭代标记**：蓝色边框和"当前"标签
- **进度条**：任务完成进度可视化

### 模块成熟度显示
- **模块卡片**：状态和完成率显示
- **进度条**：完成率可视化
- **更新时间**：最后更新时间显示

## 示例场景

### 完整工作流程示例

**用户需求**："用COX技能做一个博客"

**COX响应流程**：
1. 理解需求：博客系统开发
2. 规划项目：3个迭代（基础功能、评论功能、用户系统）
3. 生成可观测数据
4. 展示迭代1计划
5. 用户确认后传递给开发技能
6. 跟踪进度并更新数据
7. 完成后询问模块反馈
8. 推进下一迭代

### 任务风险评估示例

**任务列表**：
1. [Critical+High] 修改用户认证数据结构
2. [Critical+Low] 优化登录API响应时间  
3. [High+Low] 添加用户头像功能
4. [Medium+High] 重构权限管理系统

**实施建议**：
- **第一批**：任务2 + 任务3（低风险批量处理）
- **第二批**：任务1（高风险单独处理，立即验证）
- **第三批**：任务4（根据情况决定验证方式）

## 最佳实践

### 迭代规划最佳实践
- 每个迭代目标明确且可验证
- 优先实现用户可见的功能
- 及时更新项目数据反映实际进展

### 任务管理最佳实践
- 任务大小适中，便于跟踪
- 考虑任务依赖关系
- 定期更新任务状态

### 风险管理最佳实践
- 高风险任务单独处理
- 及时验证高风险修改
- 保持数据备份和回滚能力

---

*本文档为SKILL.md中迭代管理流程的详细实现指南，具体概念和流程概览请参考SKILL.md文档。*